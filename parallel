if [[ $# -lt 2 ]]; then
  echo "Usage: script <number of process> <output> <command> <options ...>"
  echo "E.g.: "
  echo "1. no output:               script 4 none  date +%s.%N"
  echo "2. output to ./out.000-003: script 4 ./out date +%s.%N"
  exit 1
fi

ID=$[ $1-1 ]
for i in `seq 0 $ID`
do
  if [[ $2 == "none" ]]; then
    $3 $4 $5 $6 $7 $8 $9 > /dev/null &
  else
    output=`printf "%s.%03d" $2 $i`
    $3 $4 $5 $6 $7 $8 $9 > $output &
  fi
done
wait
